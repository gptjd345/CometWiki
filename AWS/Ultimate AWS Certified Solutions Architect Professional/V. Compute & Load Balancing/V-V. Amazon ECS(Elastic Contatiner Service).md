Docker는 컨테이너 기술의 핵심을 제공하고, ECS는 이러한 Docker 컨테이너를 대규모로 관리하고 오케스트레이션하는 데 사용되는 서비스이다.

# I. Docker

- **소프트웨어 개발 플랫폼**: 앱을 배포하고 관리하는 소프트웨어 개발 플랫폼
- **컨테이너 기반**: 애플리케이션을 모든 OS에서 실행할 수 있는 컨테이너에 포장하여 배포
- **일관된 실행 환경**: 애플리케이션은 실행 위치에 관계없이 동일한 환경에서 실행
    - **시스템 호환성 문제 해결**: 모든 시스템에서 호환성 문제 없이, 예측 가능한 동작을 보임
    - **작업량 감소**: 개발, 테스트, 배포 과정에서의 작업량을 줄여줌
    - **유지보수 및 구축 용이**: 애플리케이션의 유지보수 및 구축이 용이
    - **언어/OS/기술 무관**: 모든 프로그래밍 언어, 운영 체제, 기술과 함께 작동
- **자원 제어**: 컨테이너에 할당되는 메모리와 CPU 양을 제어 가능
- **빠른 확장성**: 컨테이너를 매우 빠르게 위아래로 확장 가능(초 단위)
- **효율성**: 가상 머신보다 더 효율적으로 자원을 사용

## 1. Docker의 주요 특징

1. **컨테이너(Container)**
    - 컨테이너는 애플리케이션과 그 실행 환경을 함께 캡슐화하여, 어디서나 일관된 실행 제공
    - 가볍고, 빠르게 시작할 수 있으며, 시스템 자원을 효율적으로 사용
	    
2. **이미지(Image)**
    - Docker 이미지는 컨테이너의 실행 환경을 정의하는 템플릿
    - 이미지는 불변이며, 동일한 이미지를 사용하면 항상 동일한 실행 환경을 보장
	    
3. **도커 허브(Docker Hub)**
    - Docker Hub는 Docker 이미지를 저장하고 공유할 수 있는 클라우드 기반 레지스트리
    - 다양한 공식 이미지와 커뮤니티 이미지를 제공하여, 쉽게 애플리케이션 시작
	    
4. **도커 파일(Dockerfile)**
    - Dockerfile은 이미지를 빌드하기 위한 명령어 모음
    - 코드와 의존성을 정의하고, 이미지를 자동으로 생성

## 2. Docker의 장점
- **이식성**: 컨테이너를 사용하면 애플리케이션을 개발 환경에서 프로덕션 환경으로 쉽게 이동 가능
- **효율성**: 가상 머신보다 더 적은 자원을 사용하며, 빠르게 시작 가능
- **유연성**: 다양한 언어와 프레임워크 지원, 여러 클라우드 플랫폼에서 사용 가능
- **자동화**: CI/CD 파이프라인에 쉽게 통합하여 자동화된 배포와 테스트가 가능

# II. AWS의 Docker Containers 관리

AWS는 다양한 요구에 맞춰 여러 컨테이너 관리 옵션을 제공하여, 사용자가 필요에 따라 적합한 서비스를 선택할 수 있게 한다.

## 1. Amazon Elastic Container Service (Amazon ECS)
- 완전 관리형 컨테이너 오케스트레이션 서비스로, AWS 환경에서 Docker 컨테이너를 쉽게 실행하고 확장
- **특징**
    - AWS와 긴밀하게 통합되어 있어 높은 가용성과 보안성 제공
    - EC2 인스턴스 또는 AWS Fargate를 사용하여 컨테이너 실행 가능
    - 사용이 간편하고, AWS의 다른 서비스와 원활하게 연동

## 2. Amazon Elastic Kubernetes Service (Amazon EKS)
- Kubernetes를 관리하고 오케스트레이션하는 서비스로, AWS에서 Kubernetes 클러스터를 손쉽게 운영
- **특징**
    - 오픈 소스 Kubernetes와 완벽하게 호환
    - 자동화된 업그레이드, 패치 관리, 고가용성 제공
    - EC2 인스턴스 또는 AWS Fargate를 사용하여 컨테이너 실행 가능

## 3. AWS Fargate
- 서버리스 컨테이너 실행 환경으로, 인프라를 관리할 필요 없이 컨테이너 실행
- **특징**
    - 서버리스로 인프라 관리 부담이 없음
    - ECS 및 EKS와 통합되어 사용 가능
    - 자동으로 스케일링되며, 사용한 만큼만 비용 지불

## 4. ECS 및 EKS 작업
- ECS와 EKS를 통해 각각의 작업(Task)을 정의하고 실행할 수 있다.
- **특징**:
    - ECS 작업: 특정 컨테이너 이미지를 기반으로 작업을 정의하고, 이를 클러스터 내에서 실행
    - EKS 작업: Kubernetes의 Pod를 기반으로 작업을 정의하고, 이를 클러스터 내에서 실행

### 요약
- **Amazon ECS**: AWS에서 Docker 컨테이너를 관리하고 오케스트레이션하는 완전 관리형 서비스
- **Amazon EKS**: Kubernetes 기반의 컨테이너 오케스트레이션 서비스, AWS 환경에서 Kubernetes 클러스터를 운영
- **AWS Fargate**: 서버리스 컨테이너 실행 환경으로, 인프라 관리 없이 컨테이너 실행
- **ECS 및 EKS 작업**: 각각의 환경에서 작업을 정의하고 실행하는 방식

# III. Amazon ECS – 사용 사례

## 1. 마이크로서비스 실행
[https://aws.amazon.com/ko/microservices/](https://aws.amazon.com/ko/microservices/)
[https://aws.amazon.com/ko/blogs/tech/run-microservices-easily-with-amazon-ecs-service-connect/](https://aws.amazon.com/ko/blogs/tech/run-microservices-easily-with-amazon-ecs-service-connect/)- ECS는 마이크로서비스 아키텍처를 지원하여 애플리케이션을 작은 독립적인 서비스로 분할하여 실행
- **특징**:
    - 각 마이크로서비스는 독립적으로 배포 및 확장 가능
    - 서비스 간의 통신을 쉽게 관리
- **마이크로서비스 실행 사례**
    1. **한 컴퓨터에서 여러 Docker 컨테이너 실행**
        - Amazon ECS는 단일 EC2 인스턴스에서 여러 Docker 컨테이너 실행 가능
        - 자원을 효율적으로 사용하고 비용 절감
        - **예시**: 하나의 EC2 인스턴스에서 사용자 인증 서비스, 데이터 처리 서비스, 로그 수집 서비스 등 여러 마이크로서비스를 각각의 Docker 컨테이너로 실행
    2. **마이크로서비스 사이의 통신 강화**
        - Amazon ECS는 서비스 디스커버리 기능을 제공하여 마이크로서비스 간의 통신을 쉽게 설정하고 관리
        - **예시**: 사용자 인증 서비스가 데이터 처리 서비스와 통신할 때, ECS의 서비스 디스커버리 기능을 사용하여 서로의 위치를 쉽게 찾고 통신
    3. **응용 프로그램 부하 분산기와 네트워크 부하 분산기의 통합**
        - Amazon ECS는 Application Load Balancer(ALB)와 Network Load Balancer(NLB)와 직접 통합할 수 있어, 트래픽을 효과적으로 분산
        - **예시**: 여러 사용자로부터의 요청을 ALB가 받아서 각각의 마이크로서비스 컨테이너로 분산시켜 처리 → 트래픽의 균형을 맞추고 서비스의 가용성과 성능을 높임
    4. **자동 스케일링 기능**
        - Amazon ECS는 자동 스케일링 기능을 제공하여 트래픽 변화에 따라 컨테이너 수를 자동 조정
        - **예시**: 특정 시간대에 트래픽이 증가할 경우 ECS가 자동으로 더 많은 컨테이너를 실행하여 처리 능력을 확장, 트래픽이 줄어들면 불필요한 컨테이너를 종료하여 비용 절감

## 2. 단일 머신에서 여러 Docker 컨테이너 실행

- 한 대의 EC2 인스턴스에서 여러 Docker 컨테이너를 실행하여 자원을 효율적으로 사용
- **특징**:
    - 리소스 사용을 최적화하여 비용 절감
    - 애플리케이션의 격리성과 관리 용이성 증가

## 3. 쉬운 서비스 디스커버리

- ECS는 내장된 서비스 디스커버리 기능을 제공하여 컨테이너 간의 통신을 쉽게 설정하고 관리
- **특징**:
    - DNS 기반 서비스 디스커버리
    - AWS Cloud Map과 통합

## 4. 애플리케이션 로드 밸런서 및 네트워크 로드 밸런서와 직접 통합

- ECS는 Application Load Balancer(ALB)와 Network Load Balancer(NLB)와 통합되어 트래픽 분산을 쉽게 설정
- **특징**:
    - 트래픽 관리와 분산을 자동화
    - 고가용성과 확장성 제공

## 5. 자동 스케일링 기능

- ECS는 컨테이너의 자동 스케일링을 지원하여 트래픽 변화에 따라 자동으로 리소스를 조정
- **특징**:
    - 수요에 따라 컨테이너 수를 자동으로 조정
    - 비용 최적화와 성능 보장

## 6. 배치 처리 및 예약 작업 실행

- ECS는 배치 처리와 예약 작업을 쉽게 관리
- **특징**:
    - 정기적인 작업을 예약하여 실행 가능
    - 대규모 데이터 처리 작업에 적합

## 7. 온디맨드, 예약, 스팟 인스턴스에서 ECS 작업 실행

- ECS는 다양한 인스턴스 유형(On-demand, Reserved, Spot)을 지원하여 비용 효율적인 인프라 운영
- **특징**:
    - 비용 절감과 유연한 리소스 사용

## 8. 애플리케이션의 클라우드로의 마이그레이션

- 기존 애플리케이션을 클라우드로 마이그레이션하여 관리와 확장성 향상
- **특징**:
    - 기존 인프라에서 클라우드로의 원활한 이전
    - 클라우드 네이티브 기능 활용

## 9. 레거시 애플리케이션을 Dockerize하여 클라우드로 이전

- 온프레미스에서 실행 중인 레거시 애플리케이션을 Docker 컨테이너로 변환하여 ECS에서 실행
- **특징**:
    - 애플리케이션 현대화
    - 관리와 배포 간소화

## 10. Docker 컨테이너를 Amazon ECS로 이전

- 기존에 Docker를 사용 중인 애플리케이션을 Amazon ECS로 이동하여 관리 효율성을 높임
- **특징**:
    - AWS의 관리형 서비스 활용
    - 확장성과 가용성 증가

# IV. Amazon ECS 주요 개념

![[Amazon-ECS_Concepts.png]]

## **1. ECS Cluster -** EC2 인스턴스의 논리적 그룹화
- EC2 인스턴스의 논리적 그룹, 컨테이너가 배포되고 관리되는 단위
- **예시**: 여러 EC2 인스턴스를 하나의 클러스터로 묶어, 그 클러스터 안에서 컨테이너를 배포하고 관리

## **2. ECS Service -** 실행해야 할 태스크 수와 실행 방법을 정의
- 특정 수의 태스크를 항상 실행 상태로 유지하도록 정의
- 서비스는 로드 밸런서를 사용해 트래픽을 분산시킬 수도 있음
- **예시**: 웹 애플리케이션 서비스가 항상 3개의 태스크를 실행하도록 설정하여 가용성 유지

## **3. Task Definitions -** Docker 컨테이너 실행 방법을 ECS에 알려주는 JSON 형태의 메타데이터
- Docker 컨테이너를 어떻게 실행할지를 정의하는 JSON 형태의 메타데이터
- 이미지 이름, CPU, RAM, 네트워크 설정 등을 포함
- **예시**: 웹 서버 컨테이너를 정의하는 Task Definition에는 Nginx 이미지, 512MB RAM, 1vCPU 등의 정보 포함 가능

## **4. ECS Task -** 작업 정의 인스턴스, 실행 중인 도커 컨테이너
- Task Definition에 따라 실행되는 컨테이너의 인스턴스
- 실행 중인 도커 컨테이너를 나타냄
- **예시**: 하나의 Task는 Nginx 웹 서버 컨테이너가 실제로 EC2 인스턴스에서 실행되는 것을 의미

## **5. ECS IAM Roles**
- ECS에서 특정 역할을 수행할 수 있도록 권한을 부여하는 IAM 역할
- 주로 ECS 클러스터와 연관된 역할
- **예시**: ECS 클러스터가 S3 버킷에 접근할 수 있도록 하는 IAM 역할이 설정될 수 있음

### 5-1. **EC2 Instance Profile (인스턴스 프로파일)**
- EC2 인스턴스에서 사용되는 IAM 역할
- ECS로 API 호출, 로그 전송 등의 작업을 수행할 수 있도록 권한을 부여
- **예시**: EC2 인스턴스가 ECS API를 호출하여 클러스터 상태를 업데이트하거나 CloudWatch에 로그를 전송할 수 있음

### 5-2. **ECS Task IAM Role**
- 각 작업(Task)이 특정 역할을 수행할 수 있도록 하는 IAM 역할
- 주로 작업 내에서 AWS 리소스에 접근할 수 있도록 권한을 부여
- **예시**: 특정 Task가 S3 버킷에서 파일을 읽거나 DynamoDB 테이블에 데이터를 쓸 수 있도록 하는 IAM 역할이 설정될 수 있음.


# V. Application Load Balancer(ALB) Integration

## 1. Amazon ECS와 ALB 통합의 주요 포인트

### **Dynamic Port Mapping(동적 포트 매핑)**

- [https://ohgym.tistory.com/69](https://ohgym.tistory.com/69)
- 동적 포트 매핑을 통해, ECS는 각 컨테이너 인스턴스에 고유한 포트 할당
- 동일한 EC2 인스턴스에서 여러 컨테이너가 실행될 때 유용
- **예시**: 컨테이너 A는 포트 32768, 컨테이너 B는 포트 32769 등으로 할당

- **동일한 EC2 인스턴스에서 동일한 애플리케이션의 여러 인스턴스를 실행 가능**
    - 동적 포트 매핑을 통해 동일한 EC2 인스턴스에서 동일한 애플리케이션의 여러 인스턴스 실행 → 리소스 활용도 극대화
    - **예시**: 하나의 EC2 인스턴스에서 여러 인스턴스의 웹 서버 컨테이너가 서로 다른 포트로 실행 가능
	    
- **ALB가 EC2 인스턴스에서 올바른 포트를 찾음**
    - ALB는 동적 포트 매핑을 사용하여 각 컨테이너의 올바른 포트를 자동으로 감지하고 트래픽을 해당 포트로 라우팅
    - **예시**: ALB는 요청을 받아 적절한 컨테이너 인스턴스의 동적 포트로 트래픽 전달

## 2. 사용 사례

- **EC2 인스턴스 하나에서 실행되는 경우에도 복원력 향상**
    - 여러 컨테이너 인스턴스가 동일한 EC2 인스턴스에서 실행될 수 있어 단일 인스턴스 장애 시에도 서비스 복원력이 향상됨
    - **예시**: 하나의 EC2 인스턴스에서 여러 애플리케이션 인스턴스가 실행되므로, 한 인스턴스가 실패해도 다른 인스턴스가 계속 작동함
	    
- **CPU/코어 활용도 극대화**
    - 동일한 EC2 인스턴스에서 여러 컨테이너를 실행함으로써 CPU와 메모리 자원을 최대한 활용 가능
    - **예시**: 고성능 EC2 인스턴스를 사용하여 여러 컨테이너를 실행하면 자원 활용도를 최적화 가능
	    
- **애플리케이션 가동 시간에 영향을 주지 않고 롤링 업그레이드를 수행할 수 있는 기능**
    - ALB 통합을 통해 롤링 업그레이드를 수행할 때, 기존 컨테이너를 점진적으로 교체하여 애플리케이션 가동 시간에 영향을 주지 않음
    - **예시**: 새로운 버전의 컨테이너를 배포할 때, ALB는 새로운 컨테이너가 준비되면 트래픽을 전환하여 무중단 업그레이드를 실현

이와 같은 Amazon ECS와 ALB의 통합은 애플리케이션의 복원력, 자원 활용도, 그리고 무중단 배포를 가능하게 하여 운영 효율성을 크게 향상시킨다.

# VI. AWS Fargate

인프라 프로비저닝 없이 Docker 컨테이너를 AWS에서 실행할 수 있는 서버리스 컴퓨팅 엔진
## 1. AWS Fargate의 주요 특징

- **Docker 컨테이너 실행**
    - Fargate를 사용하면 AWS에서 직접 Docker 컨테이너 실행 가능
    - **예시**: Docker 이미지를 정의하고 이를 AWS Fargate로 배포하여 애플리케이션 실행
		
- **인프라 프로비저닝 불필요**
    - Fargate는 EC2 인스턴스를 관리할 필요 없이 컨테이너 실행 가능
    - **예시**: EC2 인스턴스를 설정하거나 관리할 필요 없이 Fargate가 모든 인프라 관리
	    
- **서버리스**
    - Fargate는 완전한 서버리스 환경을 제공하여 인프라 관리의 부담을 덜어줌
    - **예시**: 서버 관리 없이 애플리케이션의 배포와 확장이 가능
	    
- **태스크 정의 생성**
    - Fargate에서 컨테이너를 실행하기 위해서는 태스크 정의를 생성해야 함
    - **예시**: 태스크 정의에는 컨테이너 이미지, 필요한 CPU 및 메모리, 네트워크 설정 등이 포함
	    
- **CPU 및 RAM 기반 컨테이너 실행**
    - Fargate는 사용자가 필요한 CPU와 RAM에 따라 컨테이너를 실행해 줌
    - **예시**: 특정 애플리케이션이 필요한 자원 요구 사항에 맞춰 Fargate가 적절한 리소스를 할당
	    
- **확장성**
    - 태스크 수를 증가시키는 것만으로도 손쉽게 확장 가능
    - EC2 인스턴스를 추가할 필요가 없음
    - **예시**: 서비스 트래픽이 증가할 때 태스크 수를 늘려 자동으로 확장하고, 트래픽 감소 시 태스크 수를 줄여 비용 절감

## 2. 사용 사례

- **빠른 애플리케이션 배포**
    - 인프라 설정 없이 빠르게 애플리케이션 배포 가능
    - **예시**: 개발 및 테스트 환경에서 새로운 애플리케이션 버전을 신속하게 배포하여 테스트 가능
	    
- **자동 확장**
    - 트래픽 변화에 따라 자동으로 태스크 수를 조절하여 애플리케이션 확장
    - **예시**: 이벤트나 프로모션 기간 동안 트래픽이 급증할 때 자동으로 스케일 아웃하여 사용자 경험 유지
	    
- **비용 효율성**
    - 필요한 리소스만큼만 사용하므로 비용 절감됨
    - **예시**: 사용량에 따라 자동으로 리소스를 할당하고 해제하여 오버프로비저닝 방지

AWS Fargate는 서버 관리의 부담을 덜어주고, 유연한 리소스 관리와 확장성을 제공함으로써 애플리케이션 배포와 운영을 단순화한다. 이를 통해 개발자는 인프라 관리보다는 애플리케이션 코드에 더 집중할 수 있다.


# VII. Amazon ECS – Security & Networking (Amazon ECS 보안 및 네트워킹)

Amazon ECS(Elastic Container Service)는 보안 및 네트워킹 측면에서 다양한 기능을 제공한다.

## 1. 비밀 및 구성 관리

- **환경 변수 주입**:
    - 실행 중인 도커 컨테이너에 비밀 정보나 구성을 환경 변수로 주입 가능
    - **예시**: 데이터베이스 비밀번호나 API 키를 환경 변수로 설정하여 컨테이너 내에서 안전하게 사용
- **SSM 파라미터 스토어 및 시크릿 매니저 통합**
    - AWS SSM(Parameter Store)과 AWS Secrets Manager를 사용하여 비밀 정보를 안전하게 저장하고 관리
    - **예시**: 애플리케이션 실행 시 SSM Parameter Store나 Secrets Manager에서 비밀 정보를 가져와 환경 변수로 설정

## 2. ECS 작업 네트워킹

ECS에서 네트워크 모드를 설정하여 컨테이너 네트워킹을 구성할 수 있다.

- **none**:
    - 네트워크 연결이 없으며, 포트 매핑도 지원되지 않음
    - **사용 사례**: 네트워크 연결이 필요 없는 단순한 작업에 유용
	    
- **bridge**:
    - Docker의 가상 컨테이너 기반 네트워크 사용
    - **사용 사례**: 여러 컨테이너가 동일한 호스트에서 통신해야 할 때 유용
	    
- **host**:
    - Docker의 네트워크를 우회하고 기본 호스트 네트워크 인터페이스 사용
    - **사용 사례**: 높은 성능이 필요하거나, 호스트와 동일한 네트워크 환경을 공유해야 할 때 유용
	    
- **awsvpc**:
    - 인스턴스에서 시작되는 모든 작업은 자체 ENI(Elastic Network Interface)와 개인 IP 주소를 받음
    - **사용 사례**: Fargate 태스크의 기본 모드로, 단순화된 네트워킹, 강화된 보안, 보안 그룹, 모니터링, VPC 흐름 로그를 제공
    - **awsvpc 모드의 이점**
        - **자체 ENI 및 개인 IP 주소**
            - 각 작업이 고유한 ENI와 IP 주소를 받으므로 네트워크 격리와 보안 강화
            - **예시**: 각 작업이 별도의 네트워크 인터페이스를 사용하여 다른 작업과 독립적으로 통신
        - **단순화된 네트워킹**
            - 네트워크 설정이 간소화되어 관리 용이
            - **예시**: VPC 내에서의 네트워크 설정이 간단하여, 추가적인 네트워크 구성이 필요 없음
        - **강화된 보안**
            - 보안 그룹을 통해 네트워크 트래픽 제어 가능
            - **예시**: 각 작업에 맞춤형 보안 그룹을 적용하여 트래픽을 필터링하고 제어
        - **모니터링 및 VPC 흐름 로그**
            - VPC 흐름 로그를 사용하여 네트워크 트래픽 모니터링
            - **예시**: 네트워크 트래픽 분석을 통해 보안을 강화, 문제 발생 시 원인을 신속히 파악

Amazon ECS는 이러한 보안 및 네트워킹 기능을 통해 컨테이너화된 애플리케이션을 안전하게 배포하고 관리할 수 있도록 지원한다. 이를 통해 사용자는 애플리케이션의 보안과 네트워킹을 보다 효율적으로 관리할 수 있다.


# VIII. Amazon ECS – Service Auto Scaling

Amazon ECS(Elastic Container Service)의 서비스 자동 확장은 애플리케이션의 수요 변화에 따라 작업 수를 자동으로 조정하여 효율적이고 유연한 리소스 관리를 제공한다.

## 1. 자동 확장의 개요

- Amazon ECS는 AWS 애플리케이션 자동 확장 기능을 활용하여 원하는 작업 수를 자동으로 증가 또는 감소시킴
- **예시**: 애플리케이션의 트래픽이 증가하면 자동으로 작업 수를 늘려 처리 용량을 확장, 트래픽이 줄어들면 작업 수를 줄여 비용 절감

## 2. ECS 서비스 수준에서의 모니터링

- ECS 서비스는 CloudWatch를 통해 CPU 및 RAM 사용량을 추적
- **예시**: CloudWatch 메트릭을 사용하여 현재 리소스 사용량을 모니터링, 이를 기반으로 자동 확장 정책 설정

## 3. 다양한 자동 확장 전략

- **목표 추적(Target Tracking)**
    - **설**특정 CloudWatch 메트릭에 대한 목표 값을 기반으로 확장
    - **예시**: CPU 사용률을 50%로 유지하도록 설정하면, CPU 사용률이 50%를 초과할 경우 작업 수를 자동으로 증가시켜 조정
- **단계적 확장(Step Scaling)**
    - **설명**: 지정된 CloudWatch 알람을 기반으로 확장
    - **예시**: 특정 임계값을 초과하는 경우 단계적으로 작업 수를 늘리거나 줄임. ex) CPU 사용률이 70%를 초과하면 작업 수를 2개 증가시키는 방식
- **스케줄링된 스케일링(Scheduled Scaling)**
    - **설명**: 지정된 날짜와 시간에 기반하여 스케일링 수행
    - **예시**: 매일 오전 9시에 작업 수를 늘리고 오후 6시에 작업 수를 줄이는 방식으로, 예측 가능한 수요 변화에 대응

## 4. ECS 서비스 자동 스케일링 vs. EC2 자동 스케일링

- ECS 서비스 자동 스케일링(작업 수준) ≠ EC2 자동 스케일링(EC2 인스턴스 수준)
    
- **ECS 서비스 자동 스케일링(작업 수준)**
    
    - ECS 서비스 내에서 실행되는 작업 수를 조정
    - **예시**: 컨테이너화된 애플리케이션의 작업 수를 증가 또는 감소시켜, 애플리케이션의 처리 용량 조절
- **EC2 자동 스케일링(EC2 인스턴스 수준)**
    
    - EC2 인스턴스의 수를 조정하여 클러스터의 용량을 조절
    - **예시**: 클러스터의 전체 리소스 용량을 관리하기 위해 EC2 인스턴스를 추가하거나 제거

## 5. Fargate Auto Scaling

- Fargate를 사용하면 서버리스 환경에서 자동 확장을 설정하기가 훨씬 쉬워짐
- **예시**: Fargate는 서버리스 아키텍처를 제공하므로, 인프라를 관리할 필요 없이 작업 수를 자동으로 확장 또는 축소 가능

Amazon ECS의 자동 확장 기능을 통해 애플리케이션의 리소스 사용량을 효율적으로 관리하고, 변화하는 수요에 유연하게 대응할 수 있다. 이를 통해 비용을 절감하고 애플리케이션 성능을 최적화할 수 있다.

# IX. Amazon ECS – Spot Instances

## 1. ECS Classic(EC2 Launch Type)

- ECS 클래식을 사용할 때, 기본 EC2 인스턴스를 스팟 인스턴스로 설정할 수 있으며, 이는 자동 스케일링 그룹(ASG)에서 관리됨
- **배출 모드(Drain Mode)**: 스팟 인스턴스가 회수될 경우, 해당 인스턴스에서 실행 중인 작업을 안전하게 종료하기 위해 배출 모드로 전환됨
    - **사용 방법**: 배출 모드로 전환되면, 인스턴스는 새로운 작업을 받지 않으며, 기존 작업은 다른 인스턴스로 재할당됨
- **장점**: 스팟 인스턴스는 온디맨드 인스턴스에 비해 비용이 저렴하여 비용 절감에 효과적임
- **단점**: 스팟 인스턴스는 AWS가 언제든지 회수할 수 있기 때문에 신뢰성에 영향을 미침

## 2. AWS Fargate

- Fargate는 서버리스 컴퓨팅 모델로, 인프라 관리 없이 컨테이너를 실행 가능
- 온디맨드 기준 워크로드에 최소 태스크 수를 지정하여, 온디맨드 기준으로 안정적으로 워크로드를 처리 가능
- **FARGATE_SPOT**: 비용 절감을 위해 FARGATE_SPOT을 사용하여 작업을 추가 가능
- **장점**: Fargate 스팟 인스턴스는 저렴한 비용으로 사용 가능
- **단점**: AWS가 언제든지 회수할 수 있기 때문에 신뢰성에 영향을 미침
- **기타**: Fargate는 온디맨드 인스턴스와 스팟 인스턴스를 모두 지원하며, 부하에 따라 자동으로 확장 → 부하 변화에 유연하게 대응, 안정적인 성능을 유지하면서도 비용 절감

스팟 인스턴스는 비용 절감에 매우 유용하지만, 신뢰성에 영향을 미칠 수 있으므로, 중요한 작업에는 온디맨드 인스턴스를 사용하는 것이 좋다. Fargate는 이러한 부담을 덜어주며, 온디맨드와 스팟 인스턴스를 혼합하여 사용함으로써 비용과 성능의 균형을 맞출 수 있다.